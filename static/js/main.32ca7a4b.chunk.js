(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{176:function(e,t,n){},260:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(25),o=n.n(r),i=n(133),s=n(29),l=(n(176),n(265)),d=n(266),u=n(33),j=n(27),b=n(275),p=n(267),h=n(72),m=n(273),f=n(67),x=n(272),O=n(274),v=n(28),g=n(264),y=n(49),N=n(91);n(261),n(177),n(262);N.a.initializeApp({apiKey:"AIzaSyDhcxx2XJmO73jxj5LoNxtbHJ-hX3sSA8g",authDomain:"chat-app-bf6f7.firebaseapp.com",projectId:"chat-app-bf6f7",storageBucket:"chat-app-bf6f7.appspot.com",messagingSenderId:"457034179264",appId:"1:457034179264:web:da19308b3ab4ff9b064325",measurementId:"G-SJTRLM3FDW"}),N.a.analytics();var C=N.a.auth(),I=N.a.firestore();C.useEmulator("http://localhost:9099"),"localhost"===window.location.hostname&&I.useEmulator("localhost","8080");var w,R=N.a,A=function(e,t){var n=c.a.useState([]),a=Object(u.a)(n,2),r=a[0],o=a[1];return c.a.useEffect((function(){var n=I.collection(e).orderBy("createdAt");if(t){if(!t.compareValue||!t.compareValue.length)return;n=n.where(t.fieldName,t.operator,t.compareValue)}return n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(y.a)(Object(y.a)({},e.data()),{},{id:e.id})}));o(t)}))}),[e,t]),r},k=n(6),S=c.a.createContext(),U=Object(v.a)(g.a)(w||(w=Object(j.a)(["\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n"])));var V,L=function(e){var t=e.children,n=c.a.useState({}),a=Object(u.a)(n,2),r=a[0],o=a[1],i=c.a.useState(!0),l=Object(u.a)(i,2),d=l[0],j=l[1],b=Object(s.f)();return console.log("history",b),c.a.useEffect((function(){var e=C.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;return o({displayName:t,email:n,uid:a,photoURL:c}),j(!1),void b.push("/")}j(!1),b.push("/login"),console.log(1)}));return function(){e()}}),[b]),Object(k.jsx)(S.Provider,{value:{user:r},children:d?Object(k.jsx)(U,{}):t})},M=c.a.createContext();Object(v.a)(g.a)(V||(V=Object(j.a)(["\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n"])));var T,F=function(e){var t=e.children,n=c.a.useState(!1),a=Object(u.a)(n,2),r=a[0],o=a[1],i=c.a.useState(!1),s=Object(u.a)(i,2),l=s[0],d=s[1],j=c.a.useState(""),b=Object(u.a)(j,2),p=b[0],h=b[1],m=c.a.useContext(S).user.uid,f=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:m}}),[m]),x=A("rooms",f),O=c.a.useMemo((function(){return x.find((function(e){return e.id===p}))||{}}),[x,p]),v=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:null===O||void 0===O?void 0:O.members}}),[O]),g=A("users",v);return Object(k.jsx)(M.Provider,{value:{rooms:x,members:g,isAddRoomVisible:r,setIsAddRoomVisible:o,selectedRoomId:p,setSelectedRoomId:h,selectedRoom:O,isInviteMemberVisible:l,setIsInviteMemberVisible:d},children:t})},_=n(90),z=function(e,t){I.collection(e).add(Object(y.a)(Object(y.a)({},t),{},{createdAt:R.firestore.FieldValue.serverTimestamp()}))},E=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],r=[],o=0;o<n;o++)a[o]=!1;return function e(o){for(var i=0;i<n;i++)a[i]||(a[i]=!0,c[o]=t[i],o===n-1&&r.push(c.join(" ")),e(o+1),a[i]=!1)}(0),r.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(_.a)(e),Object(_.a)(n))}),[])},P=n(268),J=v.a.div(T||(T=Object(j.a)(["\n    padding: 15px;\n\tmargin-bottom: 10px;\n\n\t.author {\n\t\tmargin-left: 5px;\n\t\tfont-weight: bold;\n\t}\n\n\t.date {\n\t\tmargin-left: 10px;\n\t\tfont-size: 11px;\n\t\tcolor: #a7a7a7;\n\t}\n\n\t.content {\n\t\tmargin-left: 38px;\n\t}\n"])));var D,B,G,H,X,K,W=function(e){var t=e.text,n=e.displayName,a=e.createdAt,c=e.photoURL;return Object(k.jsxs)(J,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(m.a,{size:"small",src:c,children:"A"}),Object(k.jsx)(P.a.Text,{className:"author",children:n}),Object(k.jsx)(P.a.Text,{className:"date",children:a})]}),Object(k.jsx)("div",{children:Object(k.jsx)(P.a.Text,{className:"content",children:t})})]})},q=v.a.div(D||(D=Object(j.a)(["\n\theight: 100vh;\n"]))),Q=v.a.div(B||(B=Object(j.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\theight: 56px;\n\tpadding: 0 16px;\n\talign-items: center;\n\tborder-bottom: 1px solid rgb(230, 230, 230);\n\n\t.header {\n\t\t&__info {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t&__title {\n\t\t\tmargin: 0;\n\t\t\tfont-weight: bold;\n\t\t}\n\n\t\t&__desc {\n\t\t\tfont-size: 12px;\n\t\t}\n\t}\n"]))),Y=v.a.div(G||(G=Object(j.a)(["\n\tdisplay: flex;\n\talign-items: center;\n"]))),Z=v.a.div(H||(H=Object(j.a)(["\n\theight: calc(100% - 56px);\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-end;\n"]))),$=Object(v.a)(p.a)(X||(X=Object(j.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding: 2px 2px 2px 0px;\n\tborder: 1px solid rgba(230, 230, 230);\n\tborder-radius: 2px;\n\n\t.ant-form-item {\n\t\tflex: 1;\n\t\tmargin-bottom: 0;\n\t\tpadding: 10px;\n\t}\n"]))),ee=v.a.div(K||(K=Object(j.a)(["\n\tmax-height: 100%;\n\toverflow-y: scroll;\n"])));var te,ne,ae=function(e){var t=c.a.useContext(M),n=t.selectedRoom,a=t.members,r=t.setIsInviteMemberVisible,o=c.a.useContext(S).user,i=o.uid,s=o.photoURL,l=o.displayName,d=c.a.useState(""),j=Object(u.a)(d,2),v=j[0],g=j[1],y=p.a.useForm(),N=Object(u.a)(y,1)[0],C=function(){z("messages",{text:v,uid:i,photoURL:s,roomId:n.id,displayName:l}),N.resetFields(["message"])},I=c.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:n.id}}),[n.id]),w=A("messages",I);return Object(k.jsx)(q,{children:(null===n||void 0===n?void 0:n.id)?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(Q,{children:[Object(k.jsxs)("div",{className:"header__info",children:[Object(k.jsxs)("p",{className:"header__title",children:[" ",null===n||void 0===n?void 0:n.name]}),Object(k.jsx)("span",{className:"header__desc",children:null===n||void 0===n?void 0:n.description})]}),Object(k.jsxs)(Y,{children:[Object(k.jsx)(h.a,{icon:Object(k.jsx)(b.a,{}),type:"text",onClick:function(){return r(!0)},children:"M\u1eddi"}),Object(k.jsx)(m.a.Group,{size:"small",maxCount:2,children:a.map((function(e){var t;return Object(k.jsx)(f.a,{title:e.displayName,children:Object(k.jsx)(m.a,{children:a.photoURL?"":null===(t=e.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase()})},e.id)}))})]})]}),Object(k.jsxs)(Z,{children:[Object(k.jsx)(ee,{children:w.map((function(e){var t;return Object(k.jsx)(W,{text:e.text,displayName:e.displayName,createdAt:null===(t=e.createdAt)||void 0===t?void 0:t.seconds,photoURL:e.photoURL},e.id)}))}),Object(k.jsxs)($,{form:N,children:[Object(k.jsx)(p.a.Item,{name:"message",children:Object(k.jsx)(x.a,{placeholder:"Nh\u1eadp tin nh\u1eafn...",bordered:!1,autoComplete:"off",onChange:function(e){g(e.target.value)},onPressEnter:C,value:v})}),Object(k.jsx)(h.a,{type:"primary",onClick:C,children:"G\u1eedi"})]})]})," "]}):Object(k.jsx)(O.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng \u0111\u1ec3 b\u1eaft \u0111\u1ea7u chat",type:"info",showIcon:!0,style:{margin:"5px"}})})},ce=n(276),re=n(271),oe=re.a.Panel,ie=Object(v.a)(oe)(te||(te=Object(j.a)(["\n\t&&& {\n\t\t.ant-collapse-header,\n\t\tp {\n\t\t\tcolor: #fff;\n\t\t}\n\n\t\t.ant-collapse-content-box {\n\t\t\tpadding: 0 40px;\n\t\t}\n\n\t\t.add-room {\n\t\t\tcolor: #fff;\n\t\t}\n\t\t.ant-btn {\n\t\t\tcolor: #000;\n\t\t\tmargin-top: 50px;\n\t\t}\n\t}\n"]))),se=Object(v.a)(P.a.Link)(ne||(ne=Object(j.a)(["\n\t&&& {\n\t\tdisplay: block;\n\t\tmargin-bottom: 5px;\n\t\tcolor: #fff;\n\t}\n"])));var le,de=function(e){var t=c.a.useContext(M),n=t.rooms,a=t.setIsAddRoomVisible,r=t.setSelectedRoomId;return Object(k.jsx)(re.a,{ghost:!0,defaultActiveKey:"1",children:Object(k.jsxs)(ie,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[n.map((function(e){return Object(k.jsx)(se,{onClick:function(){return r(e.id)},children:e.name},e.id)})),Object(k.jsx)(h.a,{type:"dashed",icon:Object(k.jsx)(ce.a,{}),className:"add-room",onClick:function(){a(!0)},children:"Th\xeam ph\xf2ng"})]},"1")})},ue=v.a.div(le||(le=Object(j.a)(["\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tpadding: 12px 16px;\n\tborder-bottom: 1px solid rgba(82, 38, 83);\n\n\t.username {\n\t\tcolor: #fff;\n\t\tmargin-left: 5px;\n\t}\n"])));var je,be=function(e){var t=Object(a.useContext)(S).user,n=t.displayName,c=t.photoURL;return Object(k.jsxs)(ue,{children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(m.a,{src:c,children:c?"":null===n||void 0===n?void 0:n.charAt(0).toUpperCase()}),Object(k.jsx)(P.a.Text,{className:"username",children:n})]}),Object(k.jsx)(h.a,{ghost:!0,onClick:function(){return C.signOut()},children:"\u0110\u0103ng Xu\u1ea5t"})]})},pe=v.a.div(je||(je=Object(j.a)(["\n\tbackground: #5468ff;\n\tcolor: #fff;\n\theight: 100vh;\n"])));var he=function(e){return Object(k.jsx)(pe,{children:Object(k.jsxs)(l.a,{children:[Object(k.jsx)(d.a,{span:24,children:Object(k.jsx)(be,{})}),Object(k.jsx)(d.a,{span:24,children:Object(k.jsx)(de,{})})]})})};var me,fe=function(e){return Object(k.jsxs)(l.a,{children:[Object(k.jsx)(d.a,{span:6,children:Object(k.jsx)(he,{})}),Object(k.jsx)(d.a,{span:18,children:Object(k.jsx)(ae,{})})]})},xe=n(89),Oe=n.n(xe),ve=n(120),ge=n(277),ye=new R.auth.FacebookAuthProvider,Ne=Object(v.a)(l.a)(me||(me=Object(j.a)(['\n\tbackground: url("https://images.pexels.com/photos/1261728/pexels-photo-1261728.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940");\n\tbackground-size: cover;\n\tbackground-repeat: no-repeat;\n\theight: 100vh;\n\talign-items: center;\n\tjustify-content: center;\n\n\t.ant-typography{\n\t\ttext-shadow: 0 0 5px #a3a3a3;\n\t}\n\t\n'])));var Ce=function(e){var t=function(){var e=Object(ve.a)(Oe.a.mark((function e(){var t,n,a;return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.signInWithPopup(ye);case 2:t=e.sent,n=t.additionalUserInfo,a=t.user,(null===n||void 0===n?void 0:n.isNewUser)&&z("users",{displayName:a.displayName,email:a.email,photoURL:a.photoURL,uid:a.uid,providerId:n.providerId,keywords:E(a.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(k.jsx)("div",{children:Object(k.jsx)(Ne,{children:Object(k.jsxs)(d.a,{span:8,children:[Object(k.jsx)(P.a.Title,{style:{textAlign:"center",color:"white"},level:3,children:"REACTJS CHAT APP"}),Object(k.jsxs)(h.a,{style:{width:"100%"},size:"large",type:"primary",onClick:t,children:[Object(k.jsx)(ge.a,{twoToneColor:"#eb2f96"})," \u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"]})]})})})},Ie=n(269);var we=function(e){var t=c.a.useContext(M),n=t.isAddRoomVisible,a=t.setIsAddRoomVisible,r=c.a.useContext(S).user.uid,o=p.a.useForm(),i=Object(u.a)(o,1)[0];return Object(k.jsx)(Ie.a,{title:"T\u1ea1o ph\xf2ng",visible:n,onOk:function(){console.log({formData:i.getFieldsValue()}),z("rooms",Object(y.a)(Object(y.a)({},i.getFieldValue()),{},{members:[r]})),i.resetFields(),a(!1)},onCancel:function(){i.resetFields(),a(!1)},children:Object(k.jsxs)(p.a,{form:i,layout:"vertical",children:[Object(k.jsx)(p.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(k.jsx)(x.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(k.jsx)(p.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(k.jsx)(x.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})},Re=n(170),Ae=n(270),ke=n(162);function Se(e){var t=e.fetchOptions,n=e.debounceTimeout,r=void 0===n?300:n,o=e.curMembers,i=Object(Re.a)(e,["fetchOptions","debounceTimeout","curMembers"]),s=Object(a.useState)(!1),l=Object(u.a)(s,2),d=l[0],j=l[1],b=Object(a.useState)([]),p=Object(u.a)(b,2),h=p[0],f=p[1],x=c.a.useMemo((function(){return Object(ke.debounce)((function(e){f([]),j(!0),t(e,o).then((function(e){f(e),j(!1)}))}),r)}),[r,t,o]);return c.a.useEffect((function(){return function(){f([])}}),[]),Object(k.jsx)(Ae.a,Object(y.a)(Object(y.a)({labelInValue:!0,filterOption:!1,onSearch:x,notFoundContent:d?Object(k.jsx)(g.a,{size:"small"}):null},i),{},{children:h.map((function(e){var t,n;return Object(k.jsxs)(Ae.a.Option,{value:e.value,title:e.label,children:[Object(k.jsx)(m.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label)]},e.value)}))}))}function Ue(e,t){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(ve.a)(Oe.a.mark((function e(t,n){return Oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(null===t||void 0===t?void 0:t.toLowerCase()),e.abrupt("return",I.collection("users").where("keywords","array-contains",t).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}})).filter((function(e){return!n.includes(e.value)}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(){var e=Object(a.useContext)(M),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,c=e.selectedRoomId,r=e.selectedRoom,o=Object(a.useState)([]),i=Object(u.a)(o,2),s=i[0],l=i[1],d=p.a.useForm(),j=Object(u.a)(d,1)[0];return Object(k.jsx)("div",{children:Object(k.jsx)(Ie.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){j.resetFields(),l([]),I.collection("rooms").doc(c).update({members:[].concat(Object(_.a)(r.members),Object(_.a)(s.map((function(e){return e.value}))))}),n(!1)},onCancel:function(){j.resetFields(),l([]),n(!1)},destroyOnClose:!0,children:Object(k.jsx)(p.a,{form:j,layout:"vertical",children:Object(k.jsx)(Se,{mode:"multiple",name:"search-user",label:"T\xean c\xe1c th\xe0nh vi\xean",value:s,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Ue,onChange:function(e){return l(e)},style:{width:"100%"},curMembers:null===r||void 0===r?void 0:r.members})})})})}var Me=function(){return Object(k.jsx)(i.a,{children:Object(k.jsx)(L,{children:Object(k.jsxs)(F,{children:[Object(k.jsxs)(s.c,{children:[Object(k.jsx)(s.a,{component:Ce,path:"/login"}),Object(k.jsx)(s.a,{component:fe,path:"/"})]}),Object(k.jsx)(we,{}),Object(k.jsx)(Le,{})]})})})};n(259);o.a.render(Object(k.jsx)(Me,{}),document.getElementById("root"))}},[[260,1,2]]]);
//# sourceMappingURL=main.32ca7a4b.chunk.js.map